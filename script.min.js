(function(h,w,a){var g=function(){var j=["Moz","Webkit","Khtml","O","Ms"],f={};return function(q,p){p=p||document.documentElement;var o=p.style,n,m,k,l;if(arguments.length===1&&typeof f[q]==="string"){return f[q]}if(typeof o[q]==="string"){return f[q]=q}m=q.charAt(0).toUpperCase()+q.slice(1);k=0;for(l=j.length;k<l;k++){n=j[k]+m;if(typeof o[n]==="string"){return f[q]=n}}}}(),z=document.documentElement,x=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),e=[{name:"csstransforms",getResult:function(){return !!g("transform")}},{name:"csstransforms3d",getResult:function(){var j=!!g("perspective");if(j){var f=document.createElement("style"),k=document.createElement("div");j="@media ("+x.join("transform-3d),(")+"modernizr)";f.textContent=j+"{#modernizr{height:3px}}";(document.head||document.getElementsByTagName("head")[0]).appendChild(f);k.id="modernizr";z.appendChild(k);j=k.offsetHeight===3;f.parentNode.removeChild(f);k.parentNode.removeChild(k)}return !!j}},{name:"csstransitions",getResult:function(){return !!g("transitionProperty")}}],s,y=e.length;if(h.Modernizr){for(s=0;s<y;s++){var d=e[s];Modernizr.hasOwnProperty(d.name)||Modernizr.addTest(d.name,d.getResult)}}else{h.Modernizr=function(){var j={_version:"1.6ish: miniModernizr for Isotope"},f=[],l,k;for(s=0;s<y;s++){l=e[s];k=l.getResult();j[l.name]=k;l=(k?"":"no-")+l.name;f.push(l)}z.className+=" "+f.join(" ");return j}()}var i={transformProp:g("transform"),fnUtils:Modernizr.csstransforms3d?{translate:function(f){return"translate3d("+f[0]+"px, "+f[1]+"px, 0) "},scale:function(f){return"scale3d("+f+", "+f+", 1) "}}:{translate:function(f){return"translate("+f[0]+"px, "+f[1]+"px) "},scale:function(f){return"scale("+f+") "}},set:function(j,f,p){var o=w(j),n=o.data("isoTransform")||{},m={},l,k={};m[f]=p;w.extend(n,m);for(l in n){k[l]=(0,i.fnUtils[l])(n[l])}f=(k.translate||"")+(k.scale||"");o.data("isoTransform",n);j.style[i.transformProp]=f}};w.cssNumber.scale=true;w.cssHooks.scale={set:function(j,f){if(typeof f==="string"){f=parseFloat(f)}i.set(j,"scale",f)},get:function(f){return(f=w.data(f,"transform"))&&f.scale?f.scale:1}};w.fx.step.scale=function(f){w.cssHooks.scale.set(f.elem,f.now+f.unit)};w.cssNumber.translate=true;w.cssHooks.translate={set:function(j,f){i.set(j,"translate",f)},get:function(f){return(f=w.data(f,"transform"))&&f.translate?f.translate:[0,0]}};var c=w.event,b;c.special.smartresize={setup:function(){w(this).bind("resize",c.special.smartresize.handler)},teardown:function(){w(this).unbind("resize",c.special.smartresize.handler)},handler:function(j,f){var l=this,k=arguments;j.type="smartresize";b&&clearTimeout(b);b=setTimeout(function(){jQuery.event.handle.apply(l,k)},f==="execAsap"?0:100)}};w.fn.smartresize=function(f){return f?this.bind("smartresize",f):this.trigger("smartresize",["execAsap"])};w.Isotope=function(j,f){this.element=w(f);this._create(j);this._init()};w.Isotope.prototype={options:{resizable:true,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:Modernizr.csstransforms&&!w.browser.opera?{opacity:0,scale:0.001}:{opacity:0},visibleStyle:Modernizr.csstransforms&&!w.browser.opera?{opacity:1,scale:1}:{opacity:1},animationEngine:w.browser.opera?"jquery":"best-available",animationOptions:{queue:false,duration:800},sortBy:"original-order",sortAscending:true,resizesContainer:true},_filterFind:function(j,f){return f?j.filter(f).add(j.find(f)):j},_create:function(j){this.options=w.extend(true,{},this.options,j);this.isNew={};this.styleQueue=[];this.elemCount=0;this.$allAtoms=this._filterFind(this.element.children(),this.options.itemSelector);this.element.css({overflow:"hidden",position:"relative"});j=false;switch(this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"")){case"none":this.applyStyleFnName="css";break;case"jquery":this.applyStyleFnName="animate";j=true;break;default:this.applyStyleFnName=Modernizr.csstransitions?"css":"animate"}this.getPositionStyles=(this.usingTransforms=Modernizr.csstransforms&&Modernizr.csstransitions&&!j)?this._translate:this._positionAbs;this.options.getSortData=w.extend(this.options.getSortData,{"original-order":function(l,k){return k.elemCount}});this._setupAtoms(this.$allAtoms);j=w(document.createElement("div"));this.element.prepend(j);this.posTop=Math.round(j.position().top);this.posLeft=Math.round(j.position().left);j.remove();var f=this;setTimeout(function(){f.element.addClass(f.options.containerClass)},0);this.options.resizable&&w(h).bind("smartresize.isotope",function(){f.element.isotope("resize")})},_isNewProp:function(f){return this.prevOpts?this.options[f]!==this.prevOpts[f]:true},_init:function(j){var f=this;w.each(["filter","sortBy","sortAscending"],function(l,k){f.isNew[k]=f._isNewProp(k)});this.$filteredAtoms=this.isNew.filter?this._filter(this.$allAtoms):this.$allAtoms;if(this.isNew.filter||this.isNew.sortBy||this.isNew.sortAscending){this._sort()}this.reLayout(j)},option:function(j,f){if(w.isPlainObject(j)){this.options=w.extend(true,this.options,j)}else{if(j&&typeof f==="undefined"){return this.options[j]}else{this.options[j]=f}}return this},_setupAtoms:function(j){var f={position:"absolute"};if(this.usingTransforms){f.left=0;f.top=0}j.css(f).addClass(this.options.itemClass);this.updateSortData(j,true)},_filter:function(j){var f=this.options.filter===""?"*":this.options.filter;if(f){var n=this.options.hiddenClass,m="."+n,l=j.not(m),k=j.filter(m);m=k;j=j.filter(f);if(f!=="*"){m=k.filter(f);f=l.not(f).toggleClass(n);f.addClass(n);this.styleQueue.push({$el:f,style:this.options.hiddenStyle})}this.styleQueue.push({$el:m,style:this.options.visibleStyle});m.removeClass(n)}return j},updateSortData:function(j,f){var n=this,m=this.options.getSortData,l,k;j.each(function(){l=w(this);k={};for(var o in m){k[o]=m[o](l,n)}l.data("isotope-sort-data",k);f&&n.elemCount++})},_sort:function(){var j=this,f=function(l){return w(l).data("isotope-sort-data")[j.options.sortBy]},k=this.options.sortAscending?1:-1;this.$filteredAtoms.sort(function(o,n){var m=f(o),l=f(n);return(m>l?1:m<l?-1:0)*k});return this},_translate:function(j,f){return{translate:[j,f]}},_positionAbs:function(j,f){return{left:j,top:f}},_pushPosition:function(j,f,k){f=this.getPositionStyles(f,k);this.styleQueue.push({$el:j,style:f})},layout:function(j,f){var m=this.options.layoutMode;this["_"+m+"Layout"](j);this.options.resizesContainer&&this.styleQueue.push({$el:this.element,style:this["_"+m+"GetContainerSize"]()});var l=this.applyStyleFnName==="animate"&&!this.isLaidOut?"css":this.applyStyleFnName,k=this.options.animationOptions;w.each(this.styleQueue,function(o,n){n.$el[l](n.style,k)});this.styleQueue=[];f&&f.call(j);this.isLaidOut=true;return this},resize:function(){return this["_"+this.options.layoutMode+"Resize"]()},reLayout:function(f){return this["_"+this.options.layoutMode+"Reset"]().layout(this.$filteredAtoms,f)},addItems:function(j,f){var k=this._filterFind(j,this.options.itemSelector);this._setupAtoms(k);this.$allAtoms=this.$allAtoms.add(k);f&&f(k)},insert:function(j,f){this.element.append(j);var k=this;this.addItems(j,function(l){l=k._filter(l);k.$filteredAtoms=k.$filteredAtoms.add(l)});this._sort().reLayout(f)},appended:function(j,f){var k=this;this.addItems(j,function(l){k.$filteredAtoms=k.$filteredAtoms.add(l);k.layout(l,f)})},remove:function(f){this.$allAtoms=this.$allAtoms.not(f);this.$filteredAtoms=this.$filteredAtoms.not(f);f.remove()},_shuffleArray:function(j){var f,l,k=j.length;if(k){for(;--k;){l=~~(Math.random()*(k+1));f=j[l];j[l]=j[k];j[k]=f}}return j},shuffle:function(f){this.options.sortBy="shuffle";this.$allAtoms=this._shuffleArray(this.$allAtoms);this.$filteredAtoms=this._filter(this.$allAtoms);return this.reLayout(f)},destroy:function(){var f=w.extend(this.options.visibleStyle,{position:"relative",top:"auto",left:"auto"});if(this.usingTransforms){f[i.transformProp]="none"}this.$allAtoms.css(f).removeClass(this.options.hiddenClass+" "+this.options.itemClass);this.element.css({width:"auto",height:"auto"}).unbind(".isotope").removeClass(this.options.containerClass).removeData("isotope");w(h).unbind(".isotope")},_getSegments:function(j,f){var m=f?"rowHeight":"columnWidth",l=f?"height":"width",k=f?"rows":"cols";this[j][m]=this.options[j]&&this.options[j][m]||this.$allAtoms["outer"+(f?"Height":"Width")](true);if(!this[j][m]){w.error(m+" calculated to be zero. Stopping Isotope plugin before divide by zero. Check that the width of first child inside the isotope container is not zero.");return this}this[l]=this.element[l]();this[j][k]=Math.max(Math.floor(this[l]/this[j][m]),1);return this},_masonryPlaceBrick:function(j,f,o){f=Math.min.apply(Math,o);for(var n=f+j.outerHeight(true),m=o.length,l=m,k=this.masonry.cols+1-m;m--;){if(o[m]===f){l=m}}this._pushPosition(j,this.masonry.columnWidth*l+this.posLeft,f);for(m=0;m<k;m++){this.masonry.colYs[l+m]=n}},_masonryLayout:function(j){var f=this;j.each(function(){var p=w(this),o=Math.ceil(p.outerWidth(true)/f.masonry.columnWidth);o=Math.min(o,f.masonry.cols);if(o===1){f._masonryPlaceBrick(p,f.masonry.cols,f.masonry.colYs)}else{var n=f.masonry.cols+1-o,m=[],l,k;for(k=0;k<n;k++){l=f.masonry.colYs.slice(k,k+o);m[k]=Math.max.apply(Math,l)}f._masonryPlaceBrick(p,n,m)}});return this},_masonryReset:function(){this.masonry={};this._getSegments("masonry");var f=this.masonry.cols;for(this.masonry.colYs=[];f--;){this.masonry.colYs.push(this.posTop)}return this},_masonryResize:function(){var f=this.masonry.cols;this._getSegments("masonry");this.masonry.cols!==f&&this.reLayout();return this},_masonryGetContainerSize:function(){return{height:Math.max.apply(Math,this.masonry.colYs)-this.posTop}},_fitRowsLayout:function(j){this.width=this.element.width();var f=this;j.each(function(){var m=w(this),l=m.outerWidth(true),k=m.outerHeight(true);if(f.fitRows.x!==0&&l+f.fitRows.x>f.width){f.fitRows.x=0;f.fitRows.y=f.fitRows.height}f._pushPosition(m,f.fitRows.x+f.posLeft,f.fitRows.y+f.posTop);f.fitRows.height=Math.max(f.fitRows.y+k,f.fitRows.height);f.fitRows.x+=l});return this},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0};return this},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResize:function(){return this.reLayout()},_cellsByRowReset:function(){this.cellsByRow={};this._getSegments("cellsByRow");this.cellsByRow.rowHeight=this.options.cellsByRow.rowHeight||this.$allAtoms.outerHeight(true);return this},_cellsByRowLayout:function(j){var f=this,k=this.cellsByRow.cols;this.cellsByRow.atomsLen=j.length;j.each(function(n){var m=w(this),l=(n%k+0.5)*f.cellsByRow.columnWidth-m.outerWidth(true)/2+f.posLeft;n=(~~(n/k)+0.5)*f.cellsByRow.rowHeight-m.outerHeight(true)/2+f.posTop;f._pushPosition(m,l,n)});return this},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.cellsByRow.atomsLen/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.posTop}},_cellsByRowResize:function(){var f=this.cellsByRow.cols;this._getSegments("cellsByRow");this.cellsByRow.cols!==f&&this.reLayout();return this},_straightDownReset:function(){this.straightDown={y:0};return this},_straightDownLayout:function(j){var f=this;j.each(function(){var k=w(this);f._pushPosition(k,f.posLeft,f.straightDown.y+f.posTop);f.straightDown.y+=k.outerHeight(true)});return this},_straightDownGetContainerSize:function(){return{height:this.straightDown.y+this.posTop}},_straightDownResize:function(){this.reLayout();return this},_masonryHorizontalPlaceBrick:function(j,f,o){f=Math.min.apply(Math,o);for(var n=f+j.outerWidth(true),m=o.length,l=m,k=this.masonryHorizontal.rows+1-m;m--;){if(o[m]===f){l=m}}this._pushPosition(j,f,this.masonryHorizontal.rowHeight*l+this.posTop);for(m=0;m<k;m++){this.masonryHorizontal.rowXs[l+m]=n}},_masonryHorizontalLayout:function(j){var f=this;j.each(function(){var p=w(this),o=Math.ceil(p.outerHeight(true)/f.masonryHorizontal.rowHeight);o=Math.min(o,f.masonryHorizontal.rows);if(o===1){f._masonryHorizontalPlaceBrick(p,f.masonryHorizontal.rows,f.masonryHorizontal.rowXs)}else{var n=f.masonryHorizontal.rows+1-o,m=[],l,k;for(k=0;k<n;k++){l=f.masonryHorizontal.rowXs.slice(k,k+o);m[k]=Math.max.apply(Math,l)}f._masonryHorizontalPlaceBrick(p,n,m)}});return this},_masonryHorizontalReset:function(){this.masonryHorizontal={};this._getSegments("masonryHorizontal",true);var f=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];f--;){this.masonryHorizontal.rowXs.push(this.posLeft)}return this},_masonryHorizontalResize:function(){var f=this.masonryHorizontal.rows;this._getSegments("masonryHorizontal",true);this.masonryHorizontal.rows!==f&&this.reLayout();return this},_masonryHorizontalGetContainerSize:function(){return{width:Math.max.apply(Math,this.masonryHorizontal.rowXs)-this.posLeft}},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0};return this},_fitColumnsLayout:function(j){var f=this;this.height=this.element.height();j.each(function(){var m=w(this),l=m.outerWidth(true),k=m.outerHeight(true);if(f.fitColumns.y!==0&&k+f.fitColumns.y>f.height){f.fitColumns.x=f.fitColumns.width;f.fitColumns.y=0}f._pushPosition(m,f.fitColumns.x+f.posLeft,f.fitColumns.y+f.posTop);f.fitColumns.width=Math.max(f.fitColumns.x+l,f.fitColumns.width);f.fitColumns.y+=k});return this},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResize:function(){return this.reLayout()},_cellsByColumnReset:function(){this.cellsByColumn={};this._getSegments("cellsByColumn",true);this.cellsByColumn.columnWidth=this.options.cellsByColumn.columnWidth||this.$allAtoms.outerHeight(true);return this},_cellsByColumnLayout:function(j){var f=this,k=this.cellsByColumn.rows;this.cellsByColumn.atomsLen=j.length;j.each(function(n){var m=w(this),l=(~~(n/k)+0.5)*f.cellsByColumn.columnWidth-m.outerWidth(true)/2+f.posLeft;n=(n%k+0.5)*f.cellsByColumn.rowHeight-m.outerHeight(true)/2+f.posTop;f._pushPosition(m,l,n)});return this},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.cellsByColumn.atomsLen/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth+this.posLeft}},_cellsByColumnResize:function(){var f=this.cellsByColumn.rows;this._getSegments("cellsByColumn",true);this.cellsByColumn.rows!==f&&this.reLayout();return this}};w.fn.imagesLoaded=function(j){var f=this.find("img"),l=f.length,k=this;f.length||j.call(this);f.bind("load",function(){--l<=0&&j.call(k)}).each(function(){if(this.complete||this.complete===a){var m=this.src;this.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";this.src=m}});return this};w.widget=w.widget||{};w.widget.bridge=w.widget.bridge||function(j,f){w.fn[j]=function(n){var m=typeof n==="string",l=Array.prototype.slice.call(arguments,1),k=this;n=!m&&l.length?w.extend.apply(null,[true,n].concat(l)):n;if(m&&n.charAt(0)==="_"){return k}m?this.each(function(){var p=w.data(this,j);if(!p){return w.error("cannot call methods on "+j+" prior to initialization; attempted to call method '"+n+"'")}if(!w.isFunction(p[n])){return w.error("no such method '"+n+"' for "+j+" widget instance")}var o=p[n].apply(p,l);if(o!==p&&o!==a){k=o;return false}}):this.each(function(){var o=w.data(this,j);o?o.option(n||{})._init():w.data(this,j,new f(n,this))});return k}};w.widget.bridge("isotope",w.Isotope)})(window,jQuery);(function(){var R=this,P=R._,W={},Z=Array.prototype,V=Object.prototype,aa=Z.slice,N=Z.unshift,K=V.toString,U=V.hasOwnProperty,M=Z.forEach,L=Z.map,J=Z.reduce,h=Z.reduceRight,g=Z.filter,e=Z.every,b=Z.some,T=Z.indexOf,a=Z.lastIndexOf;V=Array.isArray;var G=Object.keys,ab=function(c){return new X(c)};if(typeof module!=="undefined"&&module.exports){module.exports=ab;ab._=ab}else{R._=ab}ab.VERSION="1.1.4";var Y=ab.each=ab.forEach=function(i,c,l){if(i!=null){if(M&&i.forEach===M){i.forEach(c,l)}else{if(ab.isNumber(i.length)){for(var k=0,j=i.length;k<j;k++){if(c.call(l,i[k],k,i)===W){break}}}else{for(k in i){if(U.call(i,k)){if(c.call(l,i[k],k,i)===W){break}}}}}}};ab.map=function(i,c,k){var j=[];if(i==null){return j}if(L&&i.map===L){return i.map(c,k)}Y(i,function(n,m,l){j[j.length]=c.call(k,n,m,l)});return j};ab.reduce=ab.foldl=ab.inject=function(i,c,l,k){var j=l!==void 0;if(i==null){i=[]}if(J&&i.reduce===J){if(k){c=ab.bind(c,k)}return j?i.reduce(c,l):i.reduce(c)}Y(i,function(o,n,m){if(!j&&n===0){l=o;j=true}else{l=c.call(k,l,o,n,m)}});if(!j){throw new TypeError("Reduce of empty array with no initial value")}return l};ab.reduceRight=ab.foldr=function(i,c,k,j){if(i==null){i=[]}if(h&&i.reduceRight===h){if(j){c=ab.bind(c,j)}return k!==void 0?i.reduceRight(c,k):i.reduceRight(c)}i=(ab.isArray(i)?i.slice():ab.toArray(i)).reverse();return ab.reduce(i,c,k,j)};ab.find=ab.detect=function(i,c,k){var j;S(i,function(n,m,l){if(c.call(k,n,m,l)){j=n;return true}});return j};ab.filter=ab.select=function(i,c,k){var j=[];if(i==null){return j}if(g&&i.filter===g){return i.filter(c,k)}Y(i,function(n,m,l){if(c.call(k,n,m,l)){j[j.length]=n}});return j};ab.reject=function(i,c,k){var j=[];if(i==null){return j}Y(i,function(n,m,l){c.call(k,n,m,l)||(j[j.length]=n)});return j};ab.every=ab.all=function(i,c,k){c=c||ab.identity;var j=true;if(i==null){return j}if(e&&i.every===e){return i.every(c,k)}Y(i,function(n,m,l){if(!(j=j&&c.call(k,n,m,l))){return W}});return j};var S=ab.some=ab.any=function(i,c,k){c=c||ab.identity;var j=false;if(i==null){return j}if(b&&i.some===b){return i.some(c,k)}Y(i,function(n,m,l){if(j=c.call(k,n,m,l)){return W}});return j};ab.include=ab.contains=function(i,c){var j=false;if(i==null){return j}if(T&&i.indexOf===T){return i.indexOf(c)!=-1}S(i,function(k){if(j=k===c){return true}});return j};ab.invoke=function(i,c){var j=aa.call(arguments,2);return ab.map(i,function(k){return(c?k[c]:k).apply(k,j)})};ab.pluck=function(i,c){return ab.map(i,function(j){return j[c]})};ab.max=function(i,c,k){if(!c&&ab.isArray(i)){return Math.max.apply(Math,i)}var j={computed:-Infinity};Y(i,function(n,m,l){m=c?c.call(k,n,m,l):n;m>=j.computed&&(j={value:n,computed:m})});return j.value};ab.min=function(i,c,k){if(!c&&ab.isArray(i)){return Math.min.apply(Math,i)}var j={computed:Infinity};Y(i,function(n,m,l){m=c?c.call(k,n,m,l):n;m<j.computed&&(j={value:n,computed:m})});return j.value};ab.sortBy=function(i,c,j){return ab.pluck(ab.map(i,function(m,l,k){return{value:m,criteria:c.call(j,m,l,k)}}).sort(function(n,m){var l=n.criteria,k=m.criteria;return l<k?-1:l>k?1:0}),"value")};ab.sortedIndex=function(i,c,m){m=m||ab.identity;for(var l=0,k=i.length;l<k;){var j=l+k>>1;m(i[j])<m(c)?l=j+1:k=j}return l};ab.toArray=function(c){if(!c){return[]}if(c.toArray){return c.toArray()}if(ab.isArray(c)){return c}if(ab.isArguments(c)){return aa.call(c)}return ab.values(c)};ab.size=function(c){return ab.toArray(c).length};ab.first=ab.head=function(i,c,j){return c&&!j?aa.call(i,0,c):i[0]};ab.rest=ab.tail=function(i,c,j){return aa.call(i,ab.isUndefined(c)||j?1:c)};ab.last=function(c){return c[c.length-1]};ab.compact=function(c){return ab.filter(c,function(i){return !!i})};ab.flatten=function(c){return ab.reduce(c,function(i,j){if(ab.isArray(j)){return i.concat(ab.flatten(j))}i[i.length]=j;return i},[])};ab.without=function(i){var c=aa.call(arguments,1);return ab.filter(i,function(j){return !ab.include(c,j)})};ab.uniq=ab.unique=function(i,c){return ab.reduce(i,function(l,k,j){if(0==j||(c===true?ab.last(l)!=k:!ab.include(l,k))){l[l.length]=k}return l},[])};ab.intersect=function(i){var c=aa.call(arguments,1);return ab.filter(ab.uniq(i),function(j){return ab.every(c,function(k){return ab.indexOf(k,j)>=0})})};ab.zip=function(){for(var i=aa.call(arguments),c=ab.max(ab.pluck(i,"length")),k=Array(c),j=0;j<c;j++){k[j]=ab.pluck(i,""+j)}return k};ab.indexOf=function(i,c,k){if(i==null){return -1}if(k){k=ab.sortedIndex(i,c);return i[k]===c?k:-1}if(T&&i.indexOf===T){return i.indexOf(c)}k=0;for(var j=i.length;k<j;k++){if(i[k]===c){return k}}return -1};ab.lastIndexOf=function(i,c){if(i==null){return -1}if(a&&i.lastIndexOf===a){return i.lastIndexOf(c)}for(var j=i.length;j--;){if(i[j]===c){return j}}return -1};ab.range=function(i,c,m){var l=aa.call(arguments),k=l.length<=1;i=k?0:l[0];c=k?l[0]:l[1];m=l[2]||1;l=Math.max(Math.ceil((c-i)/m),0);k=0;for(var j=Array(l);k<l;){j[k++]=i;i+=m}return j};ab.bind=function(i,c){var j=aa.call(arguments,2);return function(){return i.apply(c||{},j.concat(aa.call(arguments)))}};ab.bindAll=function(i){var c=aa.call(arguments,1);if(c.length==0){c=ab.functions(i)}Y(c,function(j){i[j]=ab.bind(i[j],i)});return i};ab.memoize=function(i,c){var j={};c=c||ab.identity;return function(){var k=c.apply(this,arguments);return k in j?j[k]:j[k]=i.apply(this,arguments)}};ab.delay=function(i,c){var j=aa.call(arguments,2);return setTimeout(function(){return i.apply(i,j)},c)};ab.defer=function(c){return ab.delay.apply(ab,[c,1].concat(aa.call(arguments,1)))};var Q=function(i,c,k){var j;return function(){var n=this,m=arguments,l=function(){j=null;i.apply(n,m)};k&&clearTimeout(j);if(k||!j){j=setTimeout(l,c)}}};ab.throttle=function(i,c){return Q(i,c,false)};ab.debounce=function(i,c){return Q(i,c,true)};ab.wrap=function(i,c){return function(){var j=[i].concat(aa.call(arguments));return c.apply(this,j)}};ab.compose=function(){var c=aa.call(arguments);return function(){for(var i=aa.call(arguments),j=c.length-1;j>=0;j--){i=[c[j].apply(this,i)]}return i[0]}};ab.keys=G||function(i){if(ab.isArray(i)){return ab.range(0,i.length)}var c=[],j;for(j in i){if(U.call(i,j)){c[c.length]=j}}return c};ab.values=function(c){return ab.map(c,ab.identity)};ab.functions=ab.methods=function(c){return ab.filter(ab.keys(c),function(i){return ab.isFunction(c[i])}).sort()};ab.extend=function(c){Y(aa.call(arguments,1),function(i){for(var j in i){c[j]=i[j]}});return c};ab.clone=function(c){return ab.isArray(c)?c.slice():ab.extend({},c)};ab.tap=function(i,c){c(i);return i};ab.isEqual=function(i,c){if(i===c){return true}var l=typeof i;if(l!=typeof c){return false}if(i==c){return true}if(!i&&c||i&&!c){return false}if(i._chain){i=i._wrapped}if(c._chain){c=c._wrapped}if(i.isEqual){return i.isEqual(c)}if(ab.isDate(i)&&ab.isDate(c)){return i.getTime()===c.getTime()}if(ab.isNaN(i)&&ab.isNaN(c)){return false}if(ab.isRegExp(i)&&ab.isRegExp(c)){return i.source===c.source&&i.global===c.global&&i.ignoreCase===c.ignoreCase&&i.multiline===c.multiline}if(l!=="object"){return false}if(i.length&&i.length!==c.length){return false}l=ab.keys(i);var k=ab.keys(c);if(l.length!=k.length){return false}for(var j in i){if(!(j in c)||!ab.isEqual(i[j],c[j])){return false}}return true};ab.isEmpty=function(i){if(ab.isArray(i)||ab.isString(i)){return i.length===0}for(var c in i){if(U.call(i,c)){return false}}return true};ab.isElement=function(c){return !!(c&&c.nodeType==1)};ab.isArray=V||function(c){return K.call(c)==="[object Array]"};ab.isArguments=function(c){return !!(c&&U.call(c,"callee"))};ab.isFunction=function(c){return !!(c&&c.constructor&&c.call&&c.apply)};ab.isString=function(c){return !!(c===""||c&&c.charCodeAt&&c.substr)};ab.isNumber=function(c){return !!(c===0||c&&c.toExponential&&c.toFixed)};ab.isNaN=function(c){return c!==c};ab.isBoolean=function(c){return c===true||c===false};ab.isDate=function(c){return !!(c&&c.getTimezoneOffset&&c.setUTCFullYear)};ab.isRegExp=function(c){return !!(c&&c.test&&c.exec&&(c.ignoreCase||c.ignoreCase===false))};ab.isNull=function(c){return c===null};ab.isUndefined=function(c){return c===void 0};ab.noConflict=function(){R._=P;return this};ab.identity=function(c){return c};ab.times=function(i,c,k){for(var j=0;j<i;j++){c.call(k,j)}};ab.mixin=function(c){Y(ab.functions(c),function(i){f(i,ab[i]=c[i])})};var d=0;ab.uniqueId=function(i){var c=d++;return i?i+c:c};ab.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};ab.template=function(i,c){var j=ab.templateSettings;j="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+i.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(j.interpolate,function(l,k){return"',"+k.replace(/\\'/g,"'")+",'"}).replace(j.evaluate||null,function(l,k){return"');"+k.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";j=new Function("obj",j);return c?j(c):j};var X=function(c){this._wrapped=c};ab.prototype=X.prototype;var O=function(i,c){return c?ab(i).chain():i},f=function(i,c){X.prototype[i]=function(){var j=aa.call(arguments);N.call(j,this._wrapped);return O(c.apply(ab,j),this._chain)}};ab.mixin(ab);Y(["pop","push","reverse","shift","sort","splice","unshift"],function(i){var c=Z[i];X.prototype[i]=function(){c.apply(this._wrapped,arguments);return O(this._wrapped,this._chain)}});Y(["concat","join","slice"],function(i){var c=Z[i];X.prototype[i]=function(){return O(c.apply(this._wrapped,arguments),this._chain)}});X.prototype.chain=function(){this._chain=true;return this};X.prototype.value=function(){return this._wrapped}})();(function(){var y;y=typeof exports!=="undefined"?exports:this.Backbone={};y.VERSION="0.3.3";var x=this._;if(!x&&typeof require!=="undefined"){x=require("underscore")._}var w=this.jQuery||this.Zepto;y.emulateHTTP=false;y.emulateJSON=false;y.Events={bind:function(f,e){this._callbacks||(this._callbacks={});(this._callbacks[f]||(this._callbacks[f]=[])).push(e);return this},unbind:function(f,e){var k;if(f){if(k=this._callbacks){if(e){k=k[f];if(!k){return this}for(var j=0,h=k.length;j<h;j++){if(e===k[j]){k.splice(j,1);break}}}else{k[f]=[]}}}else{this._callbacks={}}return this},trigger:function(f){var e,k,j,h;if(!(k=this._callbacks)){return this}if(e=k[f]){j=0;for(h=e.length;j<h;j++){e[j].apply(this,Array.prototype.slice.call(arguments,1))}}if(e=k.all){j=0;for(h=e.length;j<h;j++){e[j].apply(this,arguments)}}return this}};y.Model=function(f,e){f||(f={});if(this.defaults){f=x.extend({},this.defaults,f)}this.attributes={};this._escapedAttributes={};this.cid=x.uniqueId("c");this.set(f,{silent:true});this._previousAttributes=x.clone(this.attributes);if(e&&e.collection){this.collection=e.collection}this.initialize(f,e)};x.extend(y.Model.prototype,y.Events,{_previousAttributes:null,_changed:false,initialize:function(){},toJSON:function(){return x.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(f){var e;if(e=this._escapedAttributes[f]){return e}e=this.attributes[f];return this._escapedAttributes[f]=(e==null?"":e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},set:function(f,e){e||(e={});if(!f){return this}if(f.attributes){f=f.attributes}var l=this.attributes,k=this._escapedAttributes;if(!e.silent&&this.validate&&!this._performValidation(f,e)){return false}if("id" in f){this.id=f.id}for(var j in f){var h=f[j];if(!x.isEqual(l[j],h)){l[j]=h;delete k[j];if(!e.silent){this._changed=true;this.trigger("change:"+j,this,h,e)}}}!e.silent&&this._changed&&this.change(e);return this},unset:function(f,e){e||(e={});var h={};h[f]=void 0;if(!e.silent&&this.validate&&!this._performValidation(h,e)){return false}delete this.attributes[f];delete this._escapedAttributes[f];if(!e.silent){this._changed=true;this.trigger("change:"+f,this,void 0,e);this.change(e)}return this},clear:function(f){f||(f={});var e=this.attributes,h={};for(attr in e){h[attr]=void 0}if(!f.silent&&this.validate&&!this._performValidation(h,f)){return false}this.attributes={};this._escapedAttributes={};if(!f.silent){this._changed=true;for(attr in e){this.trigger("change:"+attr,this,void 0,f)}this.change(f)}return this},fetch:function(f){f||(f={});var e=this,h=v(f.error,e,f);(this.sync||y.sync)("read",this,function(j){if(!e.set(e.parse(j),f)){return false}f.success&&f.success(e,j)},h);return this},save:function(f,e){e||(e={});if(f&&!this.set(f,e)){return false}var k=this,j=v(e.error,k,e),h=this.isNew()?"create":"update";(this.sync||y.sync)(h,this,function(l){if(!k.set(k.parse(l),e)){return false}e.success&&e.success(k,l)},j);return this},destroy:function(f){f||(f={});var e=this,h=v(f.error,e,f);(this.sync||y.sync)("delete",this,function(j){e.collection&&e.collection.remove(e);f.success&&f.success(e,j)},h);return this},url:function(){var e=u(this.collection);if(this.isNew()){return e}return e+(e.charAt(e.length-1)=="/"?"":"/")+this.id},parse:function(e){return e},clone:function(){return new this.constructor(this)},isNew:function(){return !this.id},change:function(e){this.trigger("change",this,e);this._previousAttributes=x.clone(this.attributes);this._changed=false},hasChanged:function(e){if(e){return this._previousAttributes[e]!=this.attributes[e]}return this._changed},changedAttributes:function(f){f||(f=this.attributes);var e=this._previousAttributes,j=false,h;for(h in f){if(!x.isEqual(e[h],f[h])){j=j||{};j[h]=f[h]}}return j},previous:function(e){if(!e||!this._previousAttributes){return null}return this._previousAttributes[e]},previousAttributes:function(){return x.clone(this._previousAttributes)},_performValidation:function(f,e){var h=this.validate(f);if(h){e.error?e.error(this,h):this.trigger("error",this,h,e);return false}return true}});y.Collection=function(f,e){e||(e={});if(e.comparator){this.comparator=e.comparator;delete e.comparator}this._boundOnModelEvent=x.bind(this._onModelEvent,this);this._reset();f&&this.refresh(f,{silent:true});this.initialize(f,e)};x.extend(y.Collection.prototype,y.Events,{model:y.Model,initialize:function(){},toJSON:function(){return this.map(function(e){return e.toJSON()})},add:function(f,e){if(x.isArray(f)){for(var j=0,h=f.length;j<h;j++){this._add(f[j],e)}}else{this._add(f,e)}return this},remove:function(f,e){if(x.isArray(f)){for(var j=0,h=f.length;j<h;j++){this._remove(f[j],e)}}else{this._remove(f,e)}return this},get:function(e){if(e==null){return null}return this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},sort:function(e){e||(e={});if(!this.comparator){throw Error("Cannot sort a set without a comparator")}this.models=this.sortBy(this.comparator);e.silent||this.trigger("refresh",this,e);return this},pluck:function(e){return x.map(this.models,function(f){return f.get(e)})},refresh:function(f,e){f||(f=[]);e||(e={});this._reset();this.add(f,{silent:true});e.silent||this.trigger("refresh",this,e);return this},fetch:function(f){f||(f={});var e=this,h=v(f.error,e,f);(this.sync||y.sync)("read",this,function(j){e.refresh(e.parse(j));f.success&&f.success(e,j)},h);return this},create:function(f,e){var h=this;e||(e={});if(f instanceof y.Model){f.collection=h}else{f=new this.model(f,{collection:h})}return f.save(null,{success:function(k,j){h.add(k);e.success&&e.success(k,j)},error:e.error})},parse:function(e){return e},chain:function(){return x(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_add:function(f,e){e||(e={});f instanceof y.Model||(f=new this.model(f,{collection:this}));var h=this.getByCid(f);if(h){throw Error(["Can't add the same model to a set twice",h.id])}this._byId[f.id]=f;this._byCid[f.cid]=f;f.collection=this;this.models.splice(this.comparator?this.sortedIndex(f,this.comparator):this.length,0,f);f.bind("all",this._boundOnModelEvent);this.length++;e.silent||f.trigger("add",f,this,e);return f},_remove:function(f,e){e||(e={});f=this.getByCid(f)||this.get(f);if(!f){return null}delete this._byId[f.id];delete this._byCid[f.cid];delete f.collection;this.models.splice(this.indexOf(f),1);this.length--;e.silent||f.trigger("remove",f,this,e);f.unbind("all",this._boundOnModelEvent);return f},_onModelEvent:function(f,e){if(f==="change:id"){delete this._byId[e.previous("id")];this._byId[e.id]=e}this.trigger.apply(this,arguments)}});x.each(["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(e){y.Collection.prototype[e]=function(){return x[e].apply(x,[this.models].concat(x.toArray(arguments)))}});y.Controller=function(e){e||(e={});if(e.routes){this.routes=e.routes}this._bindRoutes();this.initialize(e)};var d=/:([\w\d]+)/g,c=/\*([\w\d]+)/g;x.extend(y.Controller.prototype,y.Events,{initialize:function(){},route:function(f,e,h){y.history||(y.history=new y.History);x.isRegExp(f)||(f=this._routeToRegExp(f));y.history.route(f,x.bind(function(j){j=this._extractParameters(f,j);h.apply(this,j);this.trigger.apply(this,["route:"+e].concat(j))},this))},saveLocation:function(e){y.history.saveLocation(e)},_bindRoutes:function(){if(this.routes){for(var f in this.routes){var e=this.routes[f];this.route(f,e,this[e])}}},_routeToRegExp:function(e){e=e.replace(d,"([^/]*)").replace(c,"(.*?)");return RegExp("^"+e+"$")},_extractParameters:function(f,e){return f.exec(e).slice(1)}});y.History=function(){this.handlers=[];this.fragment=this.getFragment();x.bindAll(this,"checkUrl")};var t=/^#*/;x.extend(y.History.prototype,{interval:50,getFragment:function(e){return(e||window.location).hash.replace(t,"")},start:function(){var e=document.documentMode;if(e=w.browser.msie&&(!e||e<=7)){this.iframe=w('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow}"onhashchange" in window&&!e?w(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);return this.loadUrl()},route:function(f,e){this.handlers.push({route:f,callback:e})},checkUrl:function(){var e=this.getFragment();if(e==this.fragment&&this.iframe){e=this.getFragment(this.iframe.location)}if(e==this.fragment||e==decodeURIComponent(this.fragment)){return false}if(this.iframe){window.location.hash=this.iframe.location.hash=e}this.loadUrl()},loadUrl:function(){var e=this.fragment=this.getFragment();return x.any(this.handlers,function(f){if(f.route.test(e)){f.callback(e);return true}})},saveLocation:function(e){e=(e||"").replace(t,"");if(this.fragment!=e){window.location.hash=this.fragment=e;if(this.iframe&&e!=this.getFragment(this.iframe.location)){this.iframe.document.open().close();this.iframe.location.hash=e}}}});y.View=function(e){this._configure(e||{});this._ensureElement();this.delegateEvents();this.initialize(e)};var b=/^(\w+)\s*(.*)$/;x.extend(y.View.prototype,y.Events,{tagName:"div",$:function(e){return w(e,this.el)},initialize:function(){},render:function(){return this},remove:function(){w(this.el).remove();return this},make:function(f,e,h){f=document.createElement(f);e&&w(f).attr(e);h&&w(f).html(h);return f},delegateEvents:function(f){if(f||(f=this.events)){w(this.el).unbind();for(var e in f){var k=f[e],j=e.match(b),h=j[1];j=j[2];k=x.bind(this[k],this);j===""?w(this.el).bind(h,k):w(this.el).delegate(j,h,k)}}},_configure:function(e){if(this.options){e=x.extend({},this.options,e)}if(e.model){this.model=e.model}if(e.collection){this.collection=e.collection}if(e.el){this.el=e.el}if(e.id){this.id=e.id}if(e.className){this.className=e.className}if(e.tagName){this.tagName=e.tagName}this.options=e},_ensureElement:function(){if(!this.el){var e={};if(this.id){e.id=this.id}if(this.className){e["class"]=this.className}this.el=this.make(this.tagName,e)}}});var i=function(f,e){var h=a(this,f,e);h.extend=i;return h};y.Model.extend=y.Collection.extend=y.Controller.extend=y.View.extend=i;var z={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};y.sync=function(f,e,k,j){var h=z[f];f=f==="create"||f==="update"?JSON.stringify(e.toJSON()):null;e={url:u(e),type:h,contentType:"application/json",data:f,dataType:"json",processData:false,success:k,error:j};if(y.emulateJSON){e.contentType="application/x-www-form-urlencoded";e.processData=true;e.data=f?{model:f}:{}}if(y.emulateHTTP){if(h==="PUT"||h==="DELETE"){if(y.emulateJSON){e.data._method=h}e.type="POST";e.beforeSend=function(l){l.setRequestHeader("X-HTTP-Method-Override",h)}}}w.ajax(e)};var g=function(){},a=function(f,e,j){var h;h=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return f.apply(this,arguments)};g.prototype=f.prototype;h.prototype=new g;e&&x.extend(h.prototype,e);j&&x.extend(h,j);h.prototype.constructor=h;h.__super__=f.prototype;return h},u=function(e){if(!(e&&e.url)){throw Error("A 'url' property or function must be specified")}return x.isFunction(e.url)?e.url():e.url},v=function(f,e,h){return function(j){f?f(e,j):e.trigger("error",e,j,h)}}})();function S4(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}function guid(){return(S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4())}window.Store=function(c){this.name=c;var d=localStorage.getItem(this.name);this.records=(d&&d.split(","))||[]};_.extend(Store.prototype,{save:function(){localStorage.setItem(this.name,this.records.join(","))},create:function(b){if(!b.id){b.id=b.attributes.id=guid()}localStorage.setItem(this.name+"-"+b.id,JSON.stringify(b));this.records.push(b.id.toString());this.save();return b},update:function(b){localStorage.setItem(this.name+"-"+b.id,JSON.stringify(b));if(!_.include(this.records,b.id.toString())){this.records.push(b.id.toString())}this.save();return b},find:function(b){return JSON.parse(localStorage.getItem(this.name+"-"+b.id))},findAll:function(){return _.map(this.records,function(b){return JSON.parse(localStorage.getItem(this.name+"-"+b))},this)},destroy:function(b){localStorage.removeItem(this.name+"-"+b.id);this.records=_.reject(this.records,function(a){return a==b.id.toString()});this.save();return b}});Backbone.sync=function(i,l,j,g){var k;var h=l.localStorage||l.collection.localStorage;switch(i){case"read":k=l.id?h.find(l):h.findAll();break;case"create":k=h.create(l);break;case"update":k=h.update(l);break;case"delete":k=h.destroy(l);break}if(k){j(k)}else{g("Record not found")}};$(function(){window.Course=Backbone.Model.extend({validate:function(a){if(a.name!==undefined&&a.name.length==0){return"Course name should not be blank."}},clear:function(){this.destroy();this.view.remove()},gradeString:function(){switch(this.get("grade")){case 0:return"R";break;case 1:return"D";break;case 2:return"C";break;case 3:return"B";break;case 4:return"A";break}},qp:function(){return this.get("units")*this.get("grade")}});window.CourseList=Backbone.Collection.extend({model:Course,localStorage:new Store("courses"),comparator:function(a){return a.get("name")},every:function(){return this.filter(function(a){return true})},qpa:function(){var a=0;var b=0;Courses.each(function(c){a+=c.get("units");b+=c.qp()});return(b/a).toFixed(2)}});window.Courses=new CourseList;window.CourseView=Backbone.View.extend({tagName:"li",className:"course",template:_.template($("#courseTemplate").html()),events:{"blur .name":"updateName","blur .units":"updateUnits","click .grades li a":"updateGrade","click .delete":"clear"},initialize:function(){_.bindAll(this,"render");this.model.bind("change",this.render);this.model.view=this},render:function(){$(this.el).html(this.template(this.model.toJSON()));$(this.el).find(".grades li."+this.model.gradeString()).addClass("selected");return this},updateName:function(b){var a=$(b.target).text();this.model.save({name:a});$("#courses").isotope("updateSortData",$(this.el)).isotope({sortBy:"name"})},updateUnits:function(a){var b=parseInt($(a.target).text());this.model.save({units:b})},updateGrade:function(b){$grade=$(b.target);var a=function(c){switch(c){case"R":return 0;break;case"D":return 1;break;case"C":return 2;break;case"B":return 3;break;case"A":return 4;break}}($grade.text());$grade.siblings().removeClass("selected");$grade.addClass("selected");this.model.save({grade:a})},remove:function(){$(this.el).fadeOut("fast",function(){$("#courses").isotope("remove",$(this)).isotope("reLayout")})},clear:function(){this.model.clear()}});window.AppView=Backbone.View.extend({el:$("body"),events:{"keypress #course_input":"createOnEnter","click #add_course":"createCourse","click #reset":"reset"},initialize:function(){$("#courses").isotope({itemSelector:".course",masonry:{columnWidth:270},getSortData:{name:function(a){return a.find(".name").text()}},sortBy:"name"});_.bindAll(this,"addOne","addAll","render");this.input=this.$("#course_input").focus();Courses.bind("add",this.addOne);Courses.bind("refresh",this.addAll);Courses.bind("all",this.updateQpa);Courses.fetch()},newAttributes:function(){return{name:this.input.val(),units:9,grade:4}},createCourse:function(){if(this.input.val()!=""){Courses.create(this.newAttributes());this.input.val("")}return false},createOnEnter:function(a){if(a.keyCode!=13){return}this.createCourse()},reset:function(){_.each(Courses.every(),function(a){a.clear()});return false},updateQpa:function(){var a=(!Courses.isEmpty())?"Your QPA is "+this.qpa():"Go on, add a course!";$("#qpa").text(a)},addOne:function(a){var b=new CourseView({model:a});$("#courses").isotope("insert",$(b.render().el))},addAll:function(){Courses.each(this.addOne)}});window.App=new AppView});